<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
    <title>Function as Data</title>
    <link rel="stylesheet" type="text/css" href="../../css/styles.css"/>
    <script type="text/javascript" src="../../lib/d3.js"></script>
</head>

<body>
<div id="container"></div>

<script type="text/javascript">

    function DataGenerator(data) {
        var instance = {};

        instance.random = function () {
            return Math.round(Math.random() * 30 + 15);
        };

        instance.run = function () {
            data.shift();
            data.push(instance.random());
            return data;
        };

        return instance;
    }

    function render(){
        var selection = d3.select("#container").selectAll("div")
                    .data(generator.run);

        selection.enter().append("div").append("span");

        selection.exit().remove();

        selection.attr("class", "v-bar")
            .style("height", function (d) {
                return d + "px";
            })
            .style("width", "10px")
            .style("display", "inline-block")
            .select("span")
                .text(function (d) {
                     return d;
                 });
    }

    var generator = DataGenerator([10, 15, 20, 25, 30, 35, 40]);

    setInterval(function () {
        render();
    }, 1500);

    render();
</script>

</body>

</html>