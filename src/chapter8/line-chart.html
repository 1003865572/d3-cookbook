<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Line Chart</title>
    <link rel="stylesheet" type="text/css" href="../../css/styles.css"/>
    <script type="text/javascript" src="../../lib/d3.js"></script>
</head>

<body>

<script type="text/javascript">
    function lineChart(){
        var _chart = {};
        
        var _width = 500, _height = 500,
            _margins = {top: 30, left: 30, right: 30, bottom: 30},
            _x, _y,
            _data = [],
            _svg;
            
        _chart.render = function(){
            _svg = d3.select("body").append("svg")
                .attr("height", _height)
                .attr("width", _width);
                
            renderAxes(_svg);
            
            var line = d3.svg.line()
                .interpolate("cardinal")
                .x(function(d){return _x(d.x);})
                .y(function(d){return _y(d.y);});
                
            _svg.selectAll("path.line")
                    .data(_data)
                .enter()
                    .append("path")
                    .attr("transform", "translate(" + xStart() + "," + yEnd() + ")")
                    .attr("class", "line");            
                    
            _svg.selectAll("path.line")
                    .data(_data)
                .transition()
                .attr("d", function(d){
                    return line(d);
                });
        };
        
        function renderAxes(svg){            
            var xAxis = d3.svg.axis()                
                    .scale(_x.range([0, quadrantWidth()]))
                    .orient("bottom");            
                    
            var yAxis = d3.svg.axis()
                    .scale(_y.range([quadrantHeight(), 0]))
                    .orient("left");
            
            svg.append("g")        
                .attr("class", "axis")
                .attr("transform", function(){
                    return "translate(" + xStart() + "," + yStart() + ")";
                })
                .call(xAxis);
                
            svg.append("g")        
                .attr("class", "axis")
                .attr("transform", function(){
                    return "translate(" + xStart() + "," + yEnd() + ")";
                })
                .call(yAxis);
        }
            
        function xStart(){
            return _margins.left;
        }        
        
        function yStart(){
            return _height - _margins.bottom;
        }
        
        function xEnd(){
            return _width - _margins.right;
        }
        
        function yEnd(){
            return _margins.top;
        }
        
        function quadrantWidth(){
            return _width - _margins.left - _margins.right;
        }
        
        function quadrantHeight(){
            return _height - _margins.top - _margins.bottom;
        }
            
        _chart.width = function(w){
            if(!arguments.length) return _width;
            _width = w;
            return _chart;
        };
        
        _chart.height = function(h){
            if(!arguments.length) return _height;
            _height = h;
            return _chart;
        };
        
        _chart.margins = function(m){
            if(!arguments.length) return _margins;
            _margins = m;
            return _chart;
        };
        
        _chart.x = function(x){
            if(!arguments.length) return _x;
            _x = x;
            return _chart;
        };
        
        _chart.y = function(y){
            if(!arguments.length) return _y;
            _y = y;
            return _chart;
        };
        
        _chart.addSeries = function(series){
            _data.push(series);
            return _chart;
        };
        
        return _chart;
    }
    
    var chart = lineChart()
        .x(d3.scale.linear().domain([0, 10]))
        .y(d3.scale.linear().domain([0, 10]))
        .addSeries(d3.range(11).map(function(i){
            return {x: i, y: i};
        }))
        .addSeries(d3.range(11).map(function(i){
            return {x: i, y: i*i / 2};
        }))
        .addSeries(d3.range(11).map(function(i){
            return {x: i, y: (Math.sin(i * 7) + 10) / 2};
        }))
        .render();
</script>

</body>

</html>